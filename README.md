# Решение тестового задания от lamoda-tech, 2023

## Инструкция по запуску
```bash
make up
```

## Остановить и удалить контейнеры, удалить созданные сети и тома (volumes)
```bash
make down
```

## Запустить все существующие тесты
```bash
make test
```

## Возникшие вопросы
1. [Что за признак доступности склада и что от него зависит?](#что-за-признак-доступности-склада-и-что-от-него-зависит)
2. [Что за размер товара, для чего это может быть полезно?](#что-за-размер-товара-для-чего-это-может-быть-полезно)
3. [Контракты: резервирование товара](#контракты-резервирование-товара)
4. [Контракты: освобождение резерва товаров](#контракты-освобождение-резерва-товаров)
5. [Контракты: получение количества оставшихся товаров](#контракты-получение-количества-оставшихся-товаров)

### Что за признак доступности склада и что от него зависит?
Первое, что пришло в голову при упоминании признака доступности – это
набор свойств, по которым можно определить, насколько склад подходит для
проведения желаемой операции. Исходя из моих знаний, географическая удаленность 
является наиболее значимым аспектом при работе с перемещением товаров 
(сервис подразумевает резервирование товаров для доставки). 
Чем дальше склад находится от клиента / другого склада, тем дороже будет
стоить доставка и тем дольше будет ждать клиент.

По этой причине доступность склада будет определяться по его удалению от
клиента в момент запроса (поскольку данные о местоположении клиента можно
узнать только в этот момент), и склад для определения доступности будет
обладать набором признаков для определения его местоположения. Для упрощения
в сервисе будет только широта и долгота, хотя при наличии данных о времени
доставки товаров от / до этого склада можно придумать более интересный набор
аспектов.

### Что за размер товара, для чего это может быть полезно?
Навскидку размер товара можно выразить 2 способами: абсолютными размерами
вроде 2 х 3 х 0,7 (м) или разбиением на категории (маленький, средний, большой).
В зависимости от размера товара зависит, какую часть пространства он займет
на складе или в транспортном средстве (ТС). Полный размер товара И его масса могут
помочь в оптимальной загрузке транспортных средств и предотвратить нежелательные
ситуации, например, невозможность положить очень длинную полку в условную газель. 
По этой причине лучше указывать абсолютные размеры и массу. В таком случае
функционал сервиса будет нетрудно дополнить валидацией данных при организации
загрузки в известное ТС.

### Контракты: резервирование товара
Требования к API:
1. Должна быть возможность резервирования нескольких товаров одного типа.
2. По возможности резервирование должно проходить на ближайшем складе.
3. Если на складе не хватает товаров, необходимо найти такую комбинацию 
складов, при которой издержки доставки будут минимальны.
4. Должна быть возможность выбора складов резервирования вручную.

Для удовлетворения требования 1 нужно добавить к каждому типу товара 
количество для резервирования.

Для удовлетворения требования 2 необходимо передать сервису местоположение
пункта назначения. Если для всех товаров склад указан вручную, передавать
местоположение не требуется.

Для удовлетворения требования 3 необходимо определить (в идеале - точный)
алгоритм расчета издержек и по нему определить оптимальный вариант заказа.
Предположим, что издержки на перевоз товаров между двумя точками
определяются как 
```math
k1 * distance * ln(max(mass, volume)) + k2
```
, где k1 и k2 - некие константы. В таком случае возможно такое распределение
резерваций, при котором издержки будут минимальны.

Для удовлетворения требования 4 необходимо добавить возможность определения
склада для каждого товара (типы товаров при этом могут дублироваться).

### Контракты: освобождение резерва товаров

Требования к API:
1. Должна быть возможность отмены резервации целиком.
2. Должна быть возможность отмены определенных товаров в рамках одной
резервации.
3. Должна быть возможность отмены товаров с определенного склада в рамках
одной резервации.
4. При частичной отмене резервации оставшаяся часть резервации должна быть
оптимизирована по издержкам.

### Контракты: получение количества оставшихся товаров

Требования к API:
1. Должна быть возможность возврата информации обо всех товарах, находящихся
на складе.
2. Должна быть возможность возврата информации только об указанных товарах,
находящихся на складе.